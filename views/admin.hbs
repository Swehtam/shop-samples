<!DOCTYPE html>
<html lang="pt-br">
	{{>head title='Admin Shop00' style='admin'}}
	<body>	
		<nav class="logo-nav">
			<a href="/"><img src="/images/logoblack.png"></a>

			<div class="user-info">
				<small>{{user.email}}</small>
				<form action="/logout" method="get"/>
					<button type="submit"> Logout </button>
				</form>
			</div>
		</nav>
		<main class="content-wrapper">
				

				<section class="crud-section">
					<h2>Create new category</h2>

					<form action="admin/category/create" method="post"/>
						<label>Name:</label>
						<input type="text" name="name" required/>
						<input type="hidden" name="_csrf" value="{{ token }}"></input>
						<button type="submit" value="submit"> Create </button>
					</form>
				</section>

				<section class="crud-section">
					<h2>Create new product</h2>

					<form action="admin/product/create?_csrf={{token}}" method="post" enctype="multipart/form-data">
						<label>Name:</label>
						<input type="text" name="name" required><br>
						
						<label>Price: $</label>
						<input type="number" name="price" min="0" step="0.05" required><br>
						
						<label>Description: </label><br>
						<textarea name="description" required></textarea><br>
						
						<label>Image:</label>
						<input type="file" name="img" required><br>
						
						<label>Category:</label>
						<select name="category">
								{{#each categories}}
								    <option value="{{this.catId}}">{{this.catName}}</option>
								{{/each}}
						</select>

						<button type="submit">Create</button>
					</form>
				</section>

				<section class="crud-section">
					<h2>Delete categories</h2>

					<table>
						<tr>
						    <th>Name</th>
						    <th></th>
						</tr>
						{{#each categories}}
						<tr>
					    	<td>{{this.catName}}</td>
					    	<td>
					    		<form action="admin/category/delete/{{this.catId}}" method="delete">
					    			<input type="hidden" name="_csrf" value="{{ token }}"></input>
					    			<button type="submit">Delete</button>
					    		</form>
					    	</td>
						</tr>					
						{{/each}}
					</table>
				</section>

				<section class="crud-section">
					<h2>Delete products</h2>

					<table>
						<tr>
						    <th>Name</th>
						    <th>Price</th> 
						    <th>Description</th>
						    <th>Image</th>
						    <th>Category</th>
						    <th></th>
						</tr>
						{{#each products}}
						
							<tr>
							    <td>{{this.prodName}}</td>
							    <td>$ {{this.price}}</td>
							    <td>{{this.description}}</td>
							    <td>{{this.img}}</td>
							    <td>{{this.category.catName}}</td> 
							    <td>
							    	<form action="admin/product/delete/{{this.prodId}}" method="delete">
							    		<input type="hidden" name="_csrf" value="{{ token }}"></input>
							    		<button type="submit">Delete</button>
							    	</form>
							    </td>
							</tr>
						{{/each}}
					</table>
				</section>

				<section class="crud-section">
					<h2>Edit Category</h2>

					<label>Select the category:</label>
					<select id="select-categories">
						{{#each categories}}
						<option value="{{this.catId}}">{{this.catName}}</option>
						{{/each}}
					</select>

					{{#each categories}}
					<div class="d-none edit-box">
						<form action="admin/category/edit/{{this.catId}}" method="post">
							<label>Name:</label>
							<input type="text" name="name" value="{{this.catName}}"required/>
							<input type="hidden" name="_csrf" value="{{ ../token }}"></input>
							<button type="submit">Edit</button>
						</form>
					</div>
					{{/each}}
				</section>

				<section class="crud-section">
					<h2>Edit product</h2>

					<label>Select the product:</label>
					<select id="select-products">
						{{#each products}}
						<option value="{{this.prodId}}">{{this.prodName}}</option>
						{{/each}}
					</select>

					{{#each products}}
					<div class="d-none edit-box">
						<form action="admin/product/edit/{{this.prodId}}?_csrf={{../token}}" method="post" enctype="multipart/form-data">
							<label>Name:</label>
							<input type="text" name="name" value="{{this.prodName}}" required><br>
							
							<label>Price: $</label>
							<input type="number" name="price" min="0" step="0.05" value="{{this.price}}" required><br>
							
							<label>Description: </label><br>
							<textarea name="description" required>{{this.description}}</textarea><br>
							
							<label>Image:</label>
							<input type="hidden" name="old-img" value="{{this.img}}">
							<input type="file" name="img"><br>
							
							<label>Category:</label>
							<select name="category">
								{{#each ../categories}}
								<option value="{{this.catId}}" {{#ifEquals this.catId ../this.catId}} selected {{/ifEquals}}>{{this.catName}}</option>
								{{/each}}
							</select>

							<button type="submit">Edit</button>
						</form>
					</div>
					{{/each}}
				</section>


				
		</main>
		
		<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="js/admin.js"></script>
	</body>
</html>
